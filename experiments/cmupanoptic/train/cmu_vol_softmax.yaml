title: "cmu_vol_softmax"
kind: "cmu"
vis_freq: 1000
vis_n_elements: 10

image_shape: [384, 384]

opt:
  criterion: "MAE"

  use_volumetric_ce_loss: true
  volumetric_ce_loss_weight: 0.01

  n_objects_per_epoch: 15000
  n_epochs: 9999

  batch_size: 5
  val_batch_size: 10

  lr: 0.0001
  process_features_lr: 0.001
  volume_net_lr: 0.001

  scale_keypoints_3d: 1.0

model:
  name: "vol"
  kind: "mpii"
  volume_aggregation_method: "softmax"

  init_weights: false
  checkpoint: ""

  use_gt_pelvis: false

  cuboid_side: 250.0

  volume_size: 64
  volume_multiplier: 1.0
  volume_softmax: true

  heatmap_softmax: true
  heatmap_multiplier: 100.0

  backbone:
    name: "resnet152"
    style: "simple"

    init_weights: true
    checkpoint: "./data/pretrained/human36m/pose_resnet_4.5_pixels_human36m.pth"

    num_joints: 17
    num_layers: 152

dataset:
  kind: "cmu"

  train:
    cmu_root: "./data/cmupanoptic"
    labels_path: "./data/cmupanoptic/cmu-multiview-labels-MRCNNbboxes.npy"
    # pred_results_path: "./data/pretrained/human36m/human36m_alg_10-04-2019/checkpoints/0060/results/train.pkl"

    with_damaged_actions: true
    undistort_images: true

    scale_bbox: 1.0

    shuffle: true
    randomize_n_views: false
    min_n_views: null
    max_n_views: null
    num_workers: 5

    choose_cameras:
      - 1
      - 2
      - 4
      - 6
      - 8
      - 10
      - 13
      - 16
      - 21
      - 24
      
    ignore_cameras: 
      - 29 # faulty
      
  val:
    cmu_root: "./data/cmupanoptic"
    labels_path: "./data/cmupanoptic/cmu-multiview-labels-MRCNNbboxes.npy"
    pred_results_path: "./data/pretrained/human36m/human36m_alg_10-04-2019/checkpoints/0060/results/val.pkl"

    undistort_images: true
    choose_cameras:
      - 0
      - 3
      - 10
      - 13
      - 16
    
    ignore_cameras: 
      - 29 # faulty
    
    scale_bbox: 1.0

    shuffle: false
    randomize_n_views: false
    min_n_views: null
    max_n_views: null
    num_workers: 10

    retain_every_n_frames_in_test: 1

frames:
  train:
    - 171026_pose3
      - [1000, 3000]

    - 171026_pose2
      - [1000, 7500]
      - [8000, 14000]

    - 171026_pose1
      - [380, 7300]
      - [7900, 14500]
      - [15400, 22400]

    - 171204_pose4
      - [500, 4300]
      - [4900, 8800]
      - [9400, 13200]
      - [14200, 17800]
      - [18700, 22500]
      - [23050, 27050]
      - [28000, 31600]

    - 171204_pose3
      - [500, 4400]
      - [5400, 9000]

    - 171204_pose2
      - [350, 4300]
      - [5000, 8800]
      - [9600, 13600]
      - [14300, 18500]
      - [19600, 23500]
      - [24200, 28200]
      - [28800, 32800]
      - [33500, 37700]

    - 171204_pose1
      - [300, 4100]
      - [4800, 8900]
      - [10000, 13600]
      - [14000, 18200]
      - [18500, 22900]
      - [23500, 27600]

  val:
    - 171204_pose5
      - [400, 4300]
      - [5000,  8500]
      - [9500, 13400]
      - [14200, 18000]
      - [19000, 22600]
      - [23500, 27100]

    - 171204_pose6
      - [1000, 4500]
      - [5150, 9100]
      - [9830, 13800]
      - [14370, 18300]
      - [19000, 22900]
